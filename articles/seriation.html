<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="corVis">
<title>Seriation in corVis â€¢ corVis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Seriation in corVis">
<meta property="og:description" content="corVis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">corVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calc_association.html">Calculating associations using corVis</a>
    <a class="dropdown-item" href="../articles/integrating_corVis.html">Integrating corVis with other packages</a>
    <a class="dropdown-item" href="../articles/scagnostic_corVis.html">Exploring pairwise associations with scagnostics and corVis</a>
    <a class="dropdown-item" href="../articles/seriation.html">Seriation in corVis</a>
    <a class="dropdown-item" href="../articles/vis_association.html">Visualising associations using corVis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Seriation in corVis</h1>
                        <h4 data-toc-skip class="author">Amit Chinwan
and Catherine Hurley</h4>
            
            <h4 data-toc-skip class="date">2023-03-16</h4>
      
      
      <div class="d-none name"><code>seriation.Rmd</code></div>
    </div>

    
    
<p>Careful ordering of graphical displays makes it easier to identify
patterns and structures. An example of simple graphical sorting is a
barplot for Covid deaths in different countries arranged in descending
order compared to the alphabetical order of the countries. Other complex
ordering examples include Friendly (2002) who demonstrated ordered
correlation displays so that groups of variables with high mutual
correlation are easily identified and Hurley (2004) who ordered
variables in a scatterplot matrix so that interesting panels were
positioned close to the main diagonal. All the above cases illustrate
how seriation, a term to describe ordering of objects, is useful to
reveal interesting patterns. This vignette focuses on the seriation
techniques used for matrix and linear displays in
<code>corVis</code>.</p>
<div class="section level2">
<h2 id="linear-displays">Linear displays<a class="anchor" aria-label="anchor" href="#linear-displays"></a>
</h2>
<p>We provide linear displays in the form of dot plots or heatmaps for
plotting association measures and conditional association measures in
<code>corVis</code>. In these displays, the items ordered are variable
pairs. We use two basic sorting techniques to seriate the variable pairs
in these displays.</p>
<p>The first technique involves using the maximum absolute value for
ordering the variable pairs. In the case of multiple measures and
conditional measures display, the variable pairs are ordered in
descending order by the maximum absolute measure value of the available
measures for each pair. This produces a display with highly associated
variable pairs at the top, simplifying the task to identify associated
variables.</p>
<p>Figure 1 shows the seriated linear display for <code>acs12</code>
(American Community Survey) data where it is easier to find highly
associated variable pairs in the plot compared to a plot with default
varaible pairs ordering. The variable pairs such as (<code>lang</code>,
<code>race</code>) and (<code>age</code>, <code>employement</code>) are
placed at the top of the display and are strongly associated.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond_assoc_cdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df</span>,<span class="st">"edu"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_assoc_linear.html">plot_assoc_linear</a></span><span class="op">(</span><span class="va">cond_assoc_cdc</span>, plot_type <span class="op">=</span> <span class="st">"dotplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="seriation_files/figure-html/linear_cond_max-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Figure 1: Conditional association measure display in linear layout
with variable pair ordered by maximum absolute measure value at each
level</p>
<p>The second technique uses the range of the measures to order variable
pairs. The pairs of variables are ordered in descending order by range.
As a result of this ordering, the variable pairs with highest range are
placed on the top of the display, making it easier for an analyst to
find variable pairs with a high difference.</p>
<p>Figure 2 shows a seriated linear display using the range technique.
It is easier to spot the variable pairs with high differences in the
plot. The variable pairs (<code>birth_qtr</code>, <code>race</code>) and
(<code>married</code>, <code>age</code>) are placed at the top of the
display and have highest difference among the measures.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_assoc_linear.html">plot_assoc_linear</a></span><span class="op">(</span><span class="va">cond_assoc_cdc</span>, plot_type <span class="op">=</span> <span class="st">"dotplot"</span>,pair_order <span class="op">=</span> <span class="st">"max_diff"</span><span class="op">)</span></span></code></pre></div>
<p><img src="seriation_files/figure-html/linear_cond_max_diff-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Figure 2: Conditional association measure display in linear layout
with variable pair ordered by maximum difference value at each level</p>
</div>
<div class="section level2">
<h2 id="matrix-displays">Matrix displays<a class="anchor" aria-label="anchor" href="#matrix-displays"></a>
</h2>
<p>We use methods from <code>DendSer</code> package to seriate matrix
displays in <code>corVis</code>. In many of the seriation algorithms for
matrix displays, the first step is to produce a dissimilarity or
similarity matrix of objects to be clustered. Here, objects are the
variables of a dataset. For each cell in the matrix, a seriation weight
<span class="math inline">\(w_{ij}\)</span> for variables <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, which measures the importance of the
cell, is assigned. The second step is to perform a hierarchical
clustering using the seriation weights <span class="math inline">\(w_{ij}\)</span> which yields a dendrogram. The
final step is to rearrange the nodes of the dendrogram such that the
ordering of the nodes minimizes a cost function. This produces an
ordering where associated variable pairs are placed adjacent or nearby
each other. As people generally read from left to right, placing the
most important cells at the beginning or top-left corner of the display
allows an analyst to immediately identify important pairs of variables.
By selecting appropriate cost function, we provide this feature for our
matrix displays.</p>
<p>We use the Lazy path length (LPL) cost function proposed by Earle and
Hurley (2015) to order the matrix displays. Let <span class="math inline">\(\pi\)</span> be an order obtained from the
hierarchical clustering of a matrix with n variables using the seriation
weights <span class="math inline">\(w_{ij}\)</span>. Then, LPL cost
function for an order <span class="math inline">\(\pi\)</span> is
defined as:</p>
<p><span class="math inline">\(LPL(\pi) = \sum_{i=1}^{n-1} (n-1)
w_{\pi(i),\pi(i+1)}\)</span></p>
<p>LPL is a weighted measure of path length and rewards orders with
short path lengths and where the weights generally increase. The method
provides a form of importance sorting and is efficient in making
interesting pairs more prominent in matrix displays by placing them at
the start and top-left position.</p>
<p>Below is a code snippet showing how <code>dser</code> function from
<code>DendSer</code> can be used to obtain an ordering for the
correlation matrix of numeric variables in <code>iris</code> data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_n</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">iris</span>,<span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">iris_n</span><span class="op">)</span></span>
<span><span class="va">o</span><span class="op">&lt;-</span><span class="fu">DendSer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DendSer/man/dser.html" class="external-link">dser</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span>,cost <span class="op">=</span> <span class="fu">DendSer</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/DendSer/man/costARc.html" class="external-link">costLPL</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris_n</span><span class="op">)</span><span class="op">[</span><span class="va">o</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Sepal.Length" "Petal.Length" "Petal.Width"  "Sepal.Width"</span></span></code></pre>
<!-- We use seriation algorithm from Earle and Hurley (2015) to achieve this for our displays. The first step is to perform hierarchical clustering of a dissimilarity matrix (either for association measure display, multiple measures display or conditional measure display). This yields a dendrogram with an ordering where highly similar variables, depending on the display, are nearby. When used in a matrix display, this ordering brings similar variables close to the diagonal. In order to put these variables on the top-left corner we need an additional sorting step. This step uses seriation weights $w_{ij}$, where $w_{ij}$ measures the importance of comparison for variables $(i,j)$ and a cost function, where the main goal is to find a dendrogram ordering which minimizes the cost function. The cost function we use in _corVis_ is lazy path length (LPL) which is a variant of travelling salesman problem and rewards a short path with increasing weights.  -->
<p>We use the sorting approach discussed above for all of our matrix
displays to obtain variable ordering.</p>
<div class="section level3">
<h3 id="association-measure-display">Association measure display<a class="anchor" aria-label="anchor" href="#association-measure-display"></a>
</h3>
<p>The association measure display plots a measure of association for
variable pairs in a dataset. The plotting function
<code>plot_assoc_matrix</code> takes a data structure with variable
pairs and corresponding measures as input. For ordering the variables, a
dissimilarity matrix is constructed first where the dissimilarity is
measured by <span class="math inline">\(-|m_{ij}|\)</span>, where <span class="math inline">\(m_{ij}\)</span> is the association measure value
for a variable pair <span class="math inline">\((i,j)\)</span>. This is
followed by hierarchical clustering using the seriation weights (similar
to the dissimilarity measure), which produces an order such that the LPL
cost function is minimised.</p>
<p>Figure 3 compares the default ordering of the variables in the
dataset with ordering obtained by seriation using LPL cost function. The
plot on the right shows highly associated variables at the top left
corner of the display, making it easier for an analyst to identify
associated pairs instantly.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assoc_cdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">assoc_cdc</span>, var_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">assoc_cdc</span><span class="op">)</span></span></code></pre></div>
<p><img src="seriation_files/figure-html/assoc_display-1.png" width="45%"><img src="seriation_files/figure-html/assoc_display-2.png" width="45%"></p>
<p>Figure 3: Association measure display for <code>cdc</code> data.
Left: variables in default order of the data; right: variables ordered
by LPL cost function</p>
<p>A user can also supply their own ordering perhaps obtained from other
algorithm by specifying <code>var_order</code> argument in the
<code>plot_assoc_matrix</code> function.</p>
</div>
<div class="section level3">
<h3 id="multiple-measures-display">Multiple measures display<a class="anchor" aria-label="anchor" href="#multiple-measures-display"></a>
</h3>
<p>The multiple measures display plots multiple measures of association
for every variable pair in the dataset. For the seriation of this
display, a similarity matrix is obtained by taking the maximum
association measure value for a variable pair. Let <span class="math inline">\(m_{ij}\)</span> denote the maximum value of the
association measure for pair <span class="math inline">\((i,j)\)</span>.
A hierarchical clustering is then performed with seriation weights <span class="math inline">\(w_{ij} = - |m_{ij}|\)</span> and an optimal
ordering is found using the LPL cost function.</p>
<p>We also use seriation to order multiple measure types in each cell of
the multiple measures display. We follow the same strategy by first
constructing a dissimilarity matrix of the association measures.
Dissimilarity between the pairs of measure types is measured by
-|Pearson correlation|. This is followed by hierarchical clustering
using weights the same as the dissimilarity measure. We find the optimal
ordering using the LPL criterion.</p>
<p>Figure 4 shows a comparison of multiple measures display before and
after seriation. The plot on the right displays variable pairs with high
measure value(s) on the top left corner, making it easier to find pairs
of variables where any of the measures is high.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multi_assoc_cdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc_all.html">calc_assoc_all</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">multi_assoc_cdc</span>, var_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">multi_assoc_cdc</span><span class="op">)</span></span></code></pre></div>
<p><img src="seriation_files/figure-html/multi_display-1.png" width="45%"><img src="seriation_files/figure-html/multi_display-2.png" width="45%"></p>
<p>Figure 4: Multiple association measures display for numeric variables
in penguins data. Left: variables in default order of the data; right:
variables ordered by LPL cost function</p>
</div>
<div class="section level3">
<h3 id="conditional-association-measures-display">Conditional association measures display<a class="anchor" aria-label="anchor" href="#conditional-association-measures-display"></a>
</h3>
<p>The conditional association measure display plots pairwise
association measures at different levels of a conditioning variable. For
ordering the variables, we use a similar strategy as with the case of
multiple measures display. The only difference is that a similarity
matrix is constructed by taking the maximum difference among association
measure values at different levels of the conditioning variable for a
variable pair.</p>
<p>For ordering levels of the conditioning variable, we follow a similar
approach used for ordering measure types in multiple measures
display.</p>
<p>Figure 5 shows the difference in conditional association measure
displays before and after seriation. The variable pairs with high
differences in measure value for a grouping variable are placed at the
beginning of the seriated display on the right. This helps in quickly
finding pairs with high group differences. The plot shows variable pairs
(<code>flip_l</code>, <code>bill_d</code>) and (<code>flip_l</code>,
<code>mass</code>) with high difference in measure value at different
levels of the conditioning variable <code>species</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond_assoc_cdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df</span>,by<span class="op">=</span><span class="st">"edu"</span><span class="op">)</span></span>
<span><span class="va">df_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">10</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">cond_assoc_cdc</span>, var_order <span class="op">=</span> <span class="va">df_order</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">cond_assoc_cdc</span><span class="op">)</span></span></code></pre></div>
<p><img src="seriation_files/figure-html/cond_display-1.png" width="45%"><img src="seriation_files/figure-html/cond_display-2.png" width="45%"></p>
<p>Figure 5: Conditional association measures display for cdc data.
Left: variables in default order of the data; right: variables ordered
by LPL cost function</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Amit Chinwan, Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
