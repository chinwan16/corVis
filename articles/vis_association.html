<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualising associations using corVis • corVis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualising associations using corVis">
<meta property="og:description" content="corVis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">corVis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calc_association.html">Calculating associations using corVis</a>
    </li>
    <li>
      <a href="../articles/integrating_corVis.html">Integrating corVis with other packages</a>
    </li>
    <li>
      <a href="../articles/scagnostic_corVis.html">Exploring pairwise associations with scagnostics and corVis</a>
    </li>
    <li>
      <a href="../articles/seriation.html">Seriation in corVis</a>
    </li>
    <li>
      <a href="../articles/vis_association.html">Visualising associations using corVis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualising associations using corVis</h1>
                        <h4 data-toc-skip class="author">Amit Chinwan
and Catherine Hurley</h4>
            
            <h4 data-toc-skip class="date">2023-03-20</h4>
      
      
      <div class="hidden name"><code>vis_association.Rmd</code></div>

    </div>

    
    
<p>corVis is an R package which calculates measures of association for
every variable pair in a dataset and helps in visualising these
associations in different ways. The package can also calculate and
visualise the pairwise association measures conditionally at different
levels of a grouping variable. This vignette focuses on the new
visualisation techniques for the calculated association and conditional
association for variable pairs in the dataset. Efficient seriation
techniques have been included to order and highlight interesting
relationships. These ordered association and conditional association
displays can help find interesting patterns in the dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"palmerpenguins"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"palmerpenguins"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://chinwan16.github.io/corVis/">corVis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="visualising-association">Visualising Association<a class="anchor" aria-label="anchor" href="#visualising-association"></a>
</h2>
<div class="section level3">
<h3 id="association-matrix-display">Association matrix display<a class="anchor" aria-label="anchor" href="#association-matrix-display"></a>
</h3>
<p>After calculating association measures among different variable
pairs, these can be visualised using different layouts.
<code>association_heatmap</code> function can be used to produce famous
matrix layout of association measures for every variable pair in the
dataset. Figure 1 shows this display for every variable pair in the
<em>penguins</em> dataset from the <em>palmerpenguins</em> package.</p>
<p>It shows a high positive Pearson’s correlation among
flipper_length_mm and body_mass_g, flipper_length_mm and bill_length_mm,
and bill_length_mm and bodymass_g. There seems to be a strong negative
Pearson’s correlation between flipper_length_mm and bill_depth_mm, and
bill_depth_mm and body_mass_g. The plot also shows that there is a high
canonical correlation between species and other variables except year
and sex, and a high canonical correlation between island and species,
which traditional correlation matrix display would omit as they are
limited to numeric variable pairs only. The variables in the matrix
display are ordered using average linkage clustering of the association
matrix to find out highly associated variables quickly.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">penguins</span></span>
<span><span class="va">assoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">assoc</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vis_association_files/figure-html/unnamed-chunk-2-1.png" alt="Figure 1: Association matrix display for penguins data" width="384"><p class="caption">
Figure 1: Association matrix display for penguins data
</p>
</div>
</div>
<div class="section level3">
<h3 id="comparing-multiple-association-measures">Comparing multiple association measures<a class="anchor" aria-label="anchor" href="#comparing-multiple-association-measures"></a>
</h3>
<p>We can also calculate multiple association measures for all the
variable pairs in the dataset and compare them. This will help in
finding out pairs of variables with a high difference among different
measures and one can then investigate these bivariate relationships in
more detail. The <code>pairwise_summary_plot</code> function can be used
to compare various measures using the matrix layout. It plots multiple
measures among the variable pairs as bars, where each bar represents one
measure of association. Figure 2 shows a matrix layout comparing
Pearson’s and Spearman’s correlation coefficient for the numeric
variable pairs in <em>penguins</em> data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_num</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">df</span>,<span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df_num</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spearman_assoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_assoc.html">update_assoc</a></span><span class="op">(</span>num_pair <span class="op">=</span> <span class="st">"tbl_cor"</span>,</span>
<span>                               num_pair_argList<span class="op">=</span> <span class="st">"spearman"</span>,</span>
<span>                               mixed_pair <span class="op">=</span> <span class="st">"tbl_cancor"</span>,</span>
<span>                               other_pair <span class="op">=</span> <span class="st">"tbl_nmi"</span><span class="op">)</span></span>
<span><span class="va">spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df_num</span>, types<span class="op">=</span><span class="va">spearman_assoc</span><span class="op">)</span></span>
<span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pearson</span>,<span class="va">spearman</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vis_association_files/figure-html/unnamed-chunk-3-1.png" alt="Figure 2: Comparing Pearson's and Spearman's correlation coefficient" width="384"><p class="caption">
Figure 2: Comparing Pearson’s and Spearman’s correlation coefficient
</p>
</div>
<p>In addition to matrix layout, we can also use linear layouts for
comparing multiple measures. Figure 3 compares the multiple association
measures for all the variable pairs in the dataset in a linear layout
with all the variable pairs listed on the y-axis and the association
measures on the x-axis. The fill of each cell corresponds to the value
of association measure. Linear layouts seems to be more suitable when
comparing high number of association measures.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pearson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tbl_cor.html">tbl_cor</a></span><span class="op">(</span><span class="va">df</span>,method<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="va">spearman</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tbl_cor.html">tbl_cor</a></span><span class="op">(</span><span class="va">df</span>,method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span></span>
<span><span class="va">kendall</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tbl_cor.html">tbl_cor</a></span><span class="op">(</span><span class="va">df</span>,method<span class="op">=</span><span class="st">"kendall"</span><span class="op">)</span></span>
<span><span class="va">cancor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tbl_cancor.html">tbl_cancor</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">nmi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tbl_nmi.html">tbl_nmi</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">assoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pearson</span>, <span class="va">spearman</span>, <span class="va">kendall</span>, <span class="va">cancor</span>, <span class="va">nmi</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_linear.html">plot_assoc_linear</a></span><span class="op">(</span><span class="va">assoc</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vis_association_files/figure-html/unnamed-chunk-4-1.png" alt="Figure 3: Comparing multiple association measures using a linear layout" width="384"><p class="caption">
Figure 3: Comparing multiple association measures using a linear layout
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="visualising-conditional-association">Visualising Conditional Association<a class="anchor" aria-label="anchor" href="#visualising-conditional-association"></a>
</h2>
<p>The package includes a function <code>calc_assoc_by</code> which
calculates the pairwise association at different levels of a categorical
conditioning variable. This helps in finding out interesting variable
triples which can be explored further prior to modeling. Figure 4 shows
a conditional association plot for the <em>penguins</em> data. Each cell
corresponding to a variable pair shows three bars which correspond to
the association measure (Pearson’s correlation for numeric pair and
Normalized mutual information for other combination of variables)
calculated at the levels of conditioning variable <em>island</em>. The
dashed line represents the overall association measure. The plot shows
that there is a high value for normalised mutual information between
bill_length_mm and species for the penguins which lived in
<em>Biscoe</em> island compared to the penguins which lived in
<em>Dream</em> island. It can also be seen that the cell corresponding
to variable pair flipper_length_mm and bill_depth_mm has a high negative
overall Pearson’s correlation and for the penguins which lived in
<em>Biscoe</em> island but positive correlation for penguins which lived
in <em>Dream</em> and <em>Torgersen</em> island. This is an instance of
Simpson’s paradox which can be taken into account during the modeling
step.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updated_assoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_assoc.html">update_assoc</a></span><span class="op">(</span>num_pair <span class="op">=</span> <span class="st">"tbl_cor"</span>,</span>
<span>                              mixed_pair <span class="op">=</span> <span class="st">"tbl_nmi"</span>,</span>
<span>                              other_pair <span class="op">=</span> <span class="st">"tbl_nmi"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cond_assoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_assoc.html">calc_assoc</a></span><span class="op">(</span><span class="va">df</span>, by<span class="op">=</span><span class="st">"island"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_assoc_matrix.html">plot_assoc_matrix</a></span><span class="op">(</span><span class="va">cond_assoc</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vis_association_files/figure-html/unnamed-chunk-5-1.png" alt="Figure 4: Conditional Association plot" width="384"><p class="caption">
Figure 4: Conditional Association plot
</p>
</div>
<p>We can also use linear layouts for displaying conditional
association. Figure 5 shows a funnel-like linear display for conditional
association measures with all the variable pairs on the y-axis, the
value of association measure on x-axis and color of the points
representing the level of the grouping variable. The linear layout
becomes more useful over the matrix layout when the number of variables
and number of levels of grouping variable are high.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_assoc_linear.html">plot_assoc_linear</a></span><span class="op">(</span><span class="va">cond_assoc</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="vis_association_files/figure-html/unnamed-chunk-6-1.png" alt="Figure 5: Conditional Association plot using linear layout" width="384"><p class="caption">
Figure 5: Conditional Association plot using linear layout
</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Amit Chinwan, Catherine Hurley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
