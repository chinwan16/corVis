% !TeX root = RJwrapper.tex
\title{corVis: An R Package for Visualising Associations and Conditional
Associations}
\author{by Amit Chinwan and Catherine Hurley}

\maketitle

\abstract{%
We present \CRANpkg{corVis}, an R package for visualizing association
and conditional association using measures of association. The package
provides matrix and linear layout for displaying bivariate association
(and grouped by levels of a categorical variable) , using measures
suitable for numerical, ordinal and nominal variables. With these
displays, an analyst can gain a quick overview about the interesting
structure and underlying patterns in the data. We provide a detailed
look at the package functions and discuss the implemented design
choices. We also provide an illustration of the package on an example
dataset.
}

\hypertarget{section-1-introduction}{%
\section{Section 1: Introduction}\label{section-1-introduction}}

As a first stage in an analysis, numerical and graphical variable
summaries are explored. Bivariate patterns can be explored with
correlation matrices and scatterplot matrices. Typically these are
applied to numerical variables only, though there are generalisations of
scatterplot matrices \citep{emerson2013generalized}, implemented in
\CRANpkg{GGally}, where both numerical and categorical variables are
used. For correlation matrices, popularized by
\citet{friendly2002corrgrams} as corrgram, an analyst would remove the
non-numeric variables and then calculate and plot correlations in a
matrix. Many datasets include a mix of variable types, and our goal is
to investigate and visualise associations among these. The new package
\CRANpkg{corVis} fills this gap and extends the correlation matrix for
different variable types.

In this work, we produce displays of bivariate association, using
measures suitable for numerical, ordinal and nominal variables. For
numeric variables we go beyond Pearson, Spearman and Kendall
correlation, and use methods such as distance correlation
\citep{szekely2007measuring}, information theory measure maximal
information coefficient (MIC) \citep{reshef2011detecting}, ace from
alternating conditional expectations algorithm and more, which are
capable of capturing non-linear patterns. We use association measures
for pairs of factor and ordered-factor (ordinal) variables and also for
mixed pairs where one variable is numeric and the other is a factor. For
numeric-ordinal and nominal-ordinal pair of variables, we do not
consider the ordering of the ordinal variable and treat them as mixed
and factor pair respectively.

Our first display uses a matrix-layout, similar to corrgram. A novel
feature is that our version can show multiple association measures for
each pair of variables, so that patterns other than linear association
can be uncovered. For high-dimensional datasets, matrix layouts become
unwieldy and run out of space, so our second display uses a linear
layout, showing one or more association measures for each pair of
variables. This is especially useful when the analyst wishes to limit
the display to pairs of variables showing non-negligible association.

We also present displays of bivariate association grouped by levels of a
categorical variable, again using matrix and linear layouts. These
displays are useful for discovering variable pairs showing different
patterns at different levels. For our displays, we use seriation methods
such that highly-associated variables or variable pairs with high
difference among the measures are placed nearby and are easier to
identify.

In this paper, we introduce the R package \CRANpkg{corVis} where these
displays are implemented. The next section provides a review of existing
packages which deal with correlation displays and a quick background on
association measures and the packages used for calculating them. Then we
describe our approach to calculate the association measures, followed by
visualizations of multiple association measures and conditional
associations. We conclude with a discussion and future work.

\hypertarget{section-2-background}{%
\section{Section 2: Background}\label{section-2-background}}

In this section we provide a brief review of existing packages used for
correlation displays and association measure used in the package
\CRANpkg{corVis}.

\hypertarget{section-2.1-literature-review-on-correlation-displays}{%
\subsection{Section 2.1: Literature Review on Correlation
Displays}\label{section-2.1-literature-review-on-correlation-displays}}

According to \citet{hills1969looking}, ``the first and sometimes only
impression gained by looking at a large correlation matrix is its
largeness''. To overcome this, \citet{murdoch1996graphical} proposed a
display for large correlation matrices which uses a matrix layout of
ellipses where the parameters of the ellipses are scaled to the
correlation values. \citet{friendly2002corrgrams} expanded on this idea
by rendering correlation values as shaded squares, bars, ellipses, or
circular `pac-man' symbols.

Nowadays, there are many R packages devoted to correlation
visualisation. Table \ref{tab:corrdisplay-packages} provides a summary,
listing the displays offered, and whether these extend to factor
variables or mixed numeric-factor pairs.

The R package \CRANpkg{corrplot} \citep{corrplot2021} provides an
implementation of the methods in \citet{friendly2002corrgrams} and
produces displays in matrix layout. The package \CRANpkg{corrr}
\citep{corrr2020} organises correlations as tidy data first, so
leveraging the data manipulation and visualisation tools of the
\CRANpkg{tidyverse} \citep{tidyverse}, which then can be displayed in a
matrix format.

The package \CRANpkg{corrgrapher} \citep{corrgrapher} uses a network
plot for exploring correlations, where the nodes close to each other
have high correlation magnitude, edge thickness encodes the absolute
correlation value and edge color indicates the sign of correlation. The
package also handles mixed type variables by using association measures
obtained as transformations of \(p\)-values obtained from Pearson's
correlation test in the case of two numeric variables, Kruskal's test
for numerical and factor variables, and a chi-squared test for two
categorical variables. The package \CRANpkg{corrr} \citep{corrr2020}
also offers network displays where line-thickness encodes correlation
magnitude, with a filtering option to discard low-correlation edges.
Another package for plotting correlations in a network layout is
\CRANpkg{linkspotter} \citep{linkspotter} which offers a variety of
association measures (distance correlation, MIC, maximum normalized
mutual information) in addition to correlation, where the measure used
depends on whether the variables are both numerical, categorical or
mixed. The results are visualized in a network plot, which may be
packaged into an interactive shiny application.

\citet{friendly2002corrgrams} also focused on ordering of the variables
for correlation displays where the variables were ordered using the
angular ordering of the first two eigen vectors of the correlation
matrix. The ordering places highly-correlated pairs of variables nearby,
making it easier to quickly identify groups of variables with high
mutual correlation. The package \CRANpkg{corrplot} \citep{corrplot2021}
provides various ordering techniques for matrix displays along with the
method implemented in \citet{friendly2002corrgrams}.

Our own package \CRANpkg{corVis} offers a variety of displays, and has
new features not available elsewhere, in particular simultaneous display
of multiple association measures, and association displays stratified by
levels of a grouping variable. This will be described in the following
sections.

There have been other extensions to correlation displays which are
useful when dealing with high dimensional datasets.
\citet{hills1969looking} proposed a QQ plot of the \(z\)-transform of
the entries of the correlation matrix to discover correlation
coefficients too large to come from a normal distribution with mean
zero. \citet{buja2016visualization} proposed Association Navigator which
is an interactive visualization tool for large correlation matrices with
upto 2000 variables. The R package \CRANpkg{scorrplot} \citep{scorr}
produces an interactive scatterplot for exploring pairwise correlations
in a large dataset by projecting variables as points on a scatterplot
with respect to some user-selected variables of interest, driven by a
geometric interpretation of correlation and encoding the correlation as
vertical gridlines in the plot. The package allows user to update
variable of interest which creates tour of the correlation space between
different projections of the data.

The R package \CRANpkg{correlationfunnel} offers a novel display which
assists in feature selection in a setting with a single response and
many predictor variables. All numeric variables including the response
are binned. All (now categorical) variables in the resulting dataset are
one-hot encoded and Pearson's correlation calculated with the response
categories. The correlations are visualised in a dot-plot display, where
predictors are ordered by maximum correlation magnitude. Correlations
between one-hot encoded variables are challenging to interpret,
especially as the number of levels increase. In corVis we offer a
similar dot-plot display, but showing multiple correlation or
association measures, or alternatively measures stratified by a grouping
variable.

\citet{grimm2017kennzahlenbasierte} explored scagnostics, which are
measures characterizing a scatterplot based on trend or density, along
with two more measures, based on smoothing splines and distance
correlation, and compared these measures for variable selection. The
general approach in her work was to calculate measures to describe
univariate and bivariate behavior for numeric variables and then select
displays based on these measures.

\begin{Schunk}
\begin{table}

\caption{\label{tab:corrdisplay-packages}List of the R packages dealing with correlation or correlation displays with information on whether the plots display multiple measures, conditional display of measures and mixed variables in a single plot}
\centering
\begin{tabular}[t]{lll}
\toprule
Package & Display & MixedVariables\\
\midrule
corrplot & heatmap & \\
corrr & heatmap/network & \\
corrgrapher & network & \\
linkspotter & network & Yes\\
correlation & heatmap/network & \\
\addlinespace
corVis & heatmap/matrix/linear & Yes\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

\hypertarget{section-2.2-literature-review-on-association-measures}{%
\subsection{Section 2.2: Literature Review on Association
Measures}\label{section-2.2-literature-review-on-association-measures}}

An association measure is defined as a numerical summary quantifying the
relationship between two or more variables. The measure is called
symmetric if its value is invariant to the choice of independent or
dependent variable during the calculation. For example, Pearson's
correlation coefficient summarizes the strength and direction in the
range \([-1,1]\) of the linear relationship present between two numeric
variables and is symmetric. Kendall's or Spearman's rank correlation
coefficient are other popular measures which assess monotonic
relationship in interval \([-1,1]\) among two numeric variables and are
symmetric measures.

Pearson's correlation is a popular association measure because of its
easier interpretability but its limitations such as influence of
outliers on its magnitude and measuring only linear dependencies makes
it a less useful measure. The recently developed measures such as
distance correlation \citep{szekely2007measuring} and MIC
\citep{reshef2011detecting} overcome these limitations and are more
suitable for datasets with both linear and non-linear patterns.

The distance correlation coefficient \citep{szekely2007measuring} is an
association measure which looks for any relationship among two numeric
variables using the distances between observations of these variables
and summarizes the relationship in \([0,1]\). The distance correlation
is \(0\) only when the variables are independent and is a symmetric
measure.

The maximal information coefficient (MIC) \citep{reshef2011detecting} is
an information theory measure which uses mutual information among the
two variables for its calculation. The main idea is to find a grid out
of possible grids on a scatterplot of two numeric variables, in order to
discretize the variables, which maximises the mutual information for the
two variables. A normalisation technique is used to make the mutual
information from different grids comparable. Referred as `a correlation
of 21st century' \citep{speed2011correlation}, MIC is capable of
summarizing different types of relationships, not just linear or
monotonic, between numeric variables and is in range \([0,1]\).
\citet{reshef2011detecting} used MIC and other related statistics to
explore pairwise relationships in large data sets such as major-league
baseball, gene expression, global health, and the human gut microbiota.

Both distance correlation and MIC have advantages of detecting
non-linear and complex relationship but these measures aren't perfect
yet. \citet{commentSimonTibshirani} showed that distance correlation has
more statistical power than MIC. Also, distance correlation is not an
approximation when compared to MIC. On the other hand, distance
correlation computation is slower as compared to the conventional
association measures such as Pearson's correlation for datasets with
high number of cases.

In addition to association measures for numeric variables, association
measures for ordinal, nominal and mixed variable pairs are useful in
exploring a multivariate dataset. We now give an overview of available
association measures for other variable types.

\citet{agresti2010analysis} provides an overview of the association
measures which are used for exploring association between ordinal
variables. Kendall's tau-b \citep{kendall1945treatment} is an
association measure which summarizes the relationship in range
\([-1,1]\) between two ordinal variables. The polychoric correlation
\citep{olsson1979maximum} measures the correlation between two ordinal
variables by assuming two normally distributed latent variables and
summarizes the association in \([-1,1]\).

The association measures for the case of nominal pair of variables
should be invariant to the order in which the categories appear.
Pearson's contingency coefficient uses the \({\chi}^2\) value from the
Pearson's \({\chi}^2\) test for independence and scale it to summarize
the association in \([0,1]\) between two nominal variables. Another
measure for nominal variable pair is the Uncertainty coefficient
\citep{theil1970estimation} measuring the proportion of uncertainty in
one variable which is explained by the other. The uncertainty
coefficient measure is in the range \([0,1]\) and is not symmetric. A
symmetric version is used by taking the mean of the uncertainty
coefficients obtained by treating each variable as independent variable
once.

\hypertarget{section-3-introducing-corvis}{%
\section{Section 3: Introducing
corVis}\label{section-3-introducing-corvis}}

Many of the existing correlation displays are limited to numeric pairs
of variables. The package \CRANpkg{corVis} extends these displays to
every variable pair. The main goal of our work is to propose displays
for multiple association measures and conditional associations which are
useful for uncovering interesting patterns in the data. This will help
in identifying variable pairs which shows a type of relationship or
pattern in a dataset with large number of variables.

While designing these displays we consider matrix and linear layouts. A
matrix layout reduces the effort in looking up for a variable pair
corresponding to a cell or panel, and different measures may be
displayed on the upper and lower triangle of the matrix. On the other
hand, the filtering of variable pairs, for example pairs having measure
value greater than a threshold, is easier with linear layouts in
comparison to matrix layouts.

Table \ref{tab:function-corVis} provides a list of the functions
available in the package. The functions \texttt{calc\_assoc} and
\texttt{calc\_assoc\_all} are responsible for calculating association
measures which are used as input for the \texttt{plot\_assoc\_matrix}
and \texttt{plot\_assoc\_linear} functions. The functions
\texttt{plot\_assoc\_matrix} and \texttt{plot\_assoc\_linear} produces
association display, multiple association measures display and
conditional association display, in a matrix and linear layout
respectively. We provide detailed examples on calculation and
visualisation of association and conditional association in next
sections.

\begin{Schunk}
\begin{table}

\caption{\label{tab:function-corVis}List of functions in corVis package}
\centering
\begin{tabular}[t]{>{}lll}
\toprule
Function & Usage & Description\\
\midrule
\textbf{calc\_assoc} & Calculation & Calculates association measures\\
\textbf{calc\_assoc\_all} & Calculation & Calculates all the association measures available in package\\
\textbf{plot\_assoc\_matrix} & Visualization & Visualize assocition and conditional association in matrix plot\\
\textbf{plot\_assoc\_linear} & Visualization & Visualize assocition and conditional association in linear plot\\
\textbf{show\_assoc} & Visualization & Association (or conditional) plot for a pair of variables\\
\bottomrule
\end{tabular}
\end{table}

\end{Schunk}

\hypertarget{example-data}{%
\section{Example: Data}\label{example-data}}

We use the Daily Bike Sharing dataset \citep{bikeref} from the R package
\CRANpkg{timetk} \citep{timetk} which contains daily count of rental
bike transactions between years 2011 and 2012 in Capital bikeshare
system. The dataset also includes corresponding daily weather
information such as humidity, temperature and windspeed, and seasonal
information such as season, whether the day is a holiday and whether the
day is a working day.

\begin{Schunk}
\begin{table}

\caption{\label{tab:bikedata}Variable description of the Daily Bike Sharing dataset}
\centering
\resizebox{\linewidth}{!}{
\begin{tabular}[t]{lll}
\toprule
Variable & Description & VariableType\\
\midrule
dteday & date & date\\
season & season with categories Winter, Spring, Summer and Fall & nominal\\
yr & year of day with categories 2011 and 2012 & nominal\\
mnth & month of day with months as categories & nominal\\
holiday & whether day is a holiday or not & nominal\\
\addlinespace
weekday & day of the week & nominal\\
workingday & if day is neither weekend nor holiday it is Yes, otherwise is No & nominal\\
weathersit & weather situation of the day with categories clear, cloudy, lightP & nominal\\
temp & normalized temperature in Celsius & numeric\\
atemp & normalized feeling temperature in Celsius & numeric\\
\addlinespace
hum & normalized humidity & numeric\\
windspeed & normalized windspeed & numeric\\
casual & count of casual users & numeric\\
registered & count of registered users & numeric\\
cnt & count of total rental bikes including both casual and registered & numeric\\
\bottomrule
\end{tabular}}
\end{table}

\end{Schunk}

Table \ref{tab:bikedata} provides a brief description of Daily Bike
Sharing data along with the types of variables present in the dataset.
We use the dataset throughout this paper for illustrative usage of the
package.

\hypertarget{section-4-corvis-calculating-association}{%
\section{Section 4: corVis: Calculating
Association}\label{section-4-corvis-calculating-association}}

This section describes the calculation of association measures in
package \CRANpkg{corVis}. The package provides a standard interface for
calculating a collection of measures which quantifies the relationship
between two variables. The measures available in the package are not
limited to numeric variables and are used with nominal, ordinal and
mixed variable pairs as well. The package also provides a functionality
for handling missing value or \texttt{NA} while calculating these
association measures.

Table \ref{tab:association-measures} lists different functions provided
in the package to calculate measures along with the information on type
of variable pairs they can be used with. It also include details about
the external package functions used to calculate and the range for these
measures. The association measures available in \CRANpkg{corVis} are
symmetric. We convert asymmetric measures to symmetric by taking either
the mean or the maximum of the measures calculated by treating each
variable from the pair as independent variable. The functions in Table
\ref{tab:association-measures} such as \texttt{tbl\_ace} and
\texttt{tbl\_cancor} which calculates maximal correlation coefficient
among the transformed variables and canonical correlation respectively,
have been implemented in \CRANpkg{corVis}.

\begin{Schunk}
\begin{table}

\caption{\label{tab:association-measures}List of the functions available in the package for calculating different association measures along with the packages used for calculation.}
\centering
\resizebox{\linewidth}{!}{
\begin{tabular}[t]{lllllll}
\toprule
name & nn & ff & oo & nf & from & range\\
\midrule
tbl\_cor & y &  &  &  & stats::cor & {}[-1,1]\\
tbl\_dcor & y &  &  &  & energy::dcor2d & {}[0,1]\\
tbl\_mine & y &  &  &  & minerva::mine & {}[0,1]\\
tbl\_ace & y & y &  & y & corVis & {}[0,1]\\
tbl\_cancor & y & y &  & y & corVis & {}[0,1]\\
\addlinespace
tbl\_nmi & y & y &  & y & linkspotter::maxNMI & {}[0,1]\\
tbl\_polycor &  &  & y &  & polycor::polychor & {}[-1,1]\\
tbl\_tau &  &  & y &  & DescTools::KendalTauA,B,C,W & {}[-1,1]\\
tbl\_gkGamma &  &  & y &  & DescTools::GoodmanKruskalGamma & {}[-1,1]\\
tbl\_gkTau &  &  & y &  & DescTools::GoodmanKruskalTau & {}[0,1]\\
\addlinespace
tbl\_uncertainty &  & y &  &  & DescTools::UncertCoef & {}[0,1]\\
tbl\_chi &  & y &  &  & DescTools::ContCoef & {}[0,1]\\
\bottomrule
\end{tabular}}
\end{table}

\end{Schunk}

For numeric pairs, the package provides popular correlation coefficients
like Pearson, Spearman or Kendall and are calculated using
\texttt{tbl\_cor} function. The measures such as distance correlation or
MIC for detecting non-linear patterns are implemented using
\texttt{tbl\_dcor} or \texttt{tbl\_mine} respectively. For ordinal
pairs, the measures such as polychoric correlation and Kendall's
coefficients are used to find association and are computed by
\texttt{tbl\_polycor} or \texttt{tbl\_tau} respectively. For nominal
pairs , the functions \texttt{tbl\_uncertainty}, \texttt{tbl\_chi} or
\texttt{tbl\_cancor} are used for exploring association among the
variables.

The function \texttt{tbl\_cancor} calculates a measure of association
based on canonical correlations for mixed pairs of variables. Nominal
variables are converted into sets of dummy variables, which are then
assigned score to find the maximal correlation. For two numeric
variables this measure is identical to absolute correlation, for two
factors the correlation is identical to that obtained from
correspondence analysis.

The functions listed in Table \ref{tab:association-measures} for
calculating association measures provide a functionality for handling
missing value or \texttt{NA} in the dataset. Each of these functions
either have a \texttt{handle.na} argument or automatically uses pairwise
complete observations (depending on the package used for calculation)
for taking care of missing values present in the data.

We do not handle date times, or circular variables (usually time
related). The only association measure which handles circular variables
is ace, but we are not so far using this feature. In the bike data the
circular variables are \texttt{season}, \texttt{month} and
\texttt{weekday}.

\hypertarget{calculating-association-measures-for-whole-dataset}{%
\subsection{Calculating association measures for whole
dataset}\label{calculating-association-measures-for-whole-dataset}}

The \texttt{calc\_assoc} function calculates association measures for
every variable pair in a dataset. The variable pairs in the output are
unique pairs in the dataset where \texttt{x} \(\neq\) \texttt{y}.
Because of the tidy structure of the output, the data manipulation and
visualization tools of \CRANpkg{tidyverse} \citep{tidyverse} are
applicable and are useful for further exploration of pairwise
associations. In addition to tibble structure, the output also has
\texttt{pairwise} and \texttt{data.frame} class which are important
class attributes for producing visual summaries in this package.

The code snippet below shows the calculation of association measures for
a subset of the bike sharing data. We select three numeric (temp,
windspeed, registered) and two nominal variables (weathersit,
workingday) from the original dataset to demostrate the usage of
\texttt{calc\_assoc}. We include all of the function arguments for the
below example and describe how these are useful. The inputs such as
\texttt{by} and \texttt{include.overall} will be described in the
section
\protect\hyperlink{calculating-conditional-association}{Calculating
conditional association}.

\begin{Schunk}
\begin{Sinput}
bike_s <- bike |> 
  dplyr::select(temp, windspeed, registered,weathersit, workingday)
bike_s_assoc <- calc_assoc(d = bike_s,
                           by = NULL,
                           types = default_assoc(),
                           include.overall = NULL,
                           handle.na = TRUE,
                           coerce_types = NULL)
bike_s_assoc
\end{Sinput}
\begin{Soutput}
#> # A tibble: 10 x 5
#>    x          y          measure measure_type pair_type
#>    <chr>      <chr>        <dbl> <chr>        <chr>    
#>  1 windspeed  temp       -0.158  pearson      numeric  
#>  2 registered temp        0.540  pearson      numeric  
#>  3 weathersit temp        0.121  cancor       mixed    
#>  4 workingday temp        0.0527 cancor       mixed    
#>  5 registered windspeed  -0.217  pearson      numeric  
#>  6 weathersit windspeed   0.120  cancor       mixed    
#>  7 workingday windspeed   0.0188 cancor       mixed    
#>  8 weathersit registered  0.282  cancor       mixed    
#>  9 workingday registered  0.304  cancor       mixed    
#> 10 workingday weathersit  0.0613 cancor       factor
\end{Soutput}
\end{Schunk}

The \texttt{types} argument is a tibble of the \texttt{tbl\_*} functions
for different types of variable pairs. The default is
\texttt{default\_assoc()} which includes \texttt{tbl\_cor} if both the
variables are numeric and calculates Pearson's correlation ,
\texttt{tbl\_gkGamma} if both the variables are ordinal and computes
Goodman and Kruskal's gamma and \texttt{tbl\_cancor} for a factor pair
and mixed pair and calculates canonical correlation.

\begin{Schunk}
\begin{Sinput}
default_measures <- default_assoc()
default_measures
\end{Sinput}
\begin{Soutput}
#> # A tibble: 4 x 4
#>   funName     typeX   typeY   argList
#>   <chr>       <chr>   <chr>   <list> 
#> 1 tbl_cor     numeric numeric <NULL> 
#> 2 tbl_cancor  factor  factor  <NULL> 
#> 3 tbl_gkGamma ordered ordered <NULL> 
#> 4 tbl_cancor  factor  numeric <NULL>
\end{Soutput}
\end{Schunk}

The default tibble of measures is updated using the
\texttt{update\_assoc} function. The argument \texttt{default} has
\texttt{default\_assoc()} tibble as its default value and is useful when
\texttt{tbl\_*} functions need to be updated for a few types of variable
pairs.

\begin{Schunk}
\begin{Sinput}
updated_assoc <- update_assoc(default_measures,
                              num_pair = "tbl_cor",
                              num_pair_argList = "spearman",
                              mixed_pair = "tbl_cancor",
                              factor_pair = "tbl_nmi")
updated_assoc
\end{Sinput}
\begin{Soutput}
#> # A tibble: 4 x 4
#>   funName     typeX   typeY   argList  
#>   <chr>       <chr>   <chr>   <list>   
#> 1 tbl_cor     numeric numeric <chr [1]>
#> 2 tbl_nmi     factor  factor  <NULL>   
#> 3 tbl_gkGamma ordered ordered <NULL>   
#> 4 tbl_cancor  factor  numeric <NULL>
\end{Soutput}
\begin{Sinput}
updated_bike_s_assoc <- calc_assoc(d = bike_s, 
                                 types = updated_assoc)
updated_bike_s_assoc
\end{Sinput}
\begin{Soutput}
#> # A tibble: 10 x 5
#>    x          y           measure measure_type pair_type
#>    <chr>      <chr>         <dbl> <chr>        <chr>    
#>  1 windspeed  temp       -0.147   spearman     numeric  
#>  2 registered temp        0.531   spearman     numeric  
#>  3 weathersit temp        0.121   cancor       mixed    
#>  4 workingday temp        0.0527  cancor       mixed    
#>  5 registered windspeed  -0.203   spearman     numeric  
#>  6 weathersit windspeed   0.120   cancor       mixed    
#>  7 workingday windspeed   0.0188  cancor       mixed    
#>  8 weathersit registered  0.282   cancor       mixed    
#>  9 workingday registered  0.304   cancor       mixed    
#> 10 workingday weathersit  0.00275 nmi          factor
\end{Soutput}
\end{Schunk}

The input \texttt{handle.na} for \texttt{calc\_assoc} manages the
\texttt{NA} or missing values in the data. The default value is set to
\texttt{TRUE} for using pairwise complete observations for calculating a
measure of association between two variables.

Sometimes an analyst might want to treat a factor as ordered. This will
also be useful for pairs of binary variables where it will then be
possible to see the direction of association. Alternatively, binary
variables are treated as numerical. The input \texttt{coerce\_types} is
used to convert variable types. The code segment below demonstrates how
nominal factors can be converted into ordinal.

\begin{Schunk}
\begin{Sinput}
bike_s_assoc <- calc_assoc(d = bike_s,
                           by = NULL,
                           types = default_assoc(),
                           include.overall = NULL,
                           handle.na = TRUE,
                           coerce_types = list(ordinal=c("workingday", "weathersit")))
bike_s_assoc
\end{Sinput}
\begin{Soutput}
#> # A tibble: 10 x 5
#>    x          y          measure measure_type pair_type
#>    <chr>      <chr>        <dbl> <chr>        <chr>    
#>  1 windspeed  temp       -0.158  pearson      numeric  
#>  2 registered temp        0.540  pearson      numeric  
#>  3 weathersit temp        0.121  cancor       mixed    
#>  4 workingday temp        0.0527 cancor       mixed    
#>  5 registered windspeed  -0.217  pearson      numeric  
#>  6 weathersit windspeed   0.120  cancor       mixed    
#>  7 workingday windspeed   0.0188 cancor       mixed    
#>  8 weathersit registered  0.282  cancor       mixed    
#>  9 workingday registered  0.304  cancor       mixed    
#> 10 workingday weathersit  0.133  gkGamma      ordered
\end{Soutput}
\end{Schunk}

\hypertarget{calculating-conditional-association}{%
\subsection{Calculating conditional
association}\label{calculating-conditional-association}}

The function \texttt{calc\_assoc} is also used to calculate association
measures for all the variable pairs at different levels of a categorical
variable. This helps in exploring the conditional associations and
finding out variable pairs showing different associations at different
levels of the conditioning variable. The function has a \texttt{by}
argument which is used as the grouping variable and needs to be
categorical. The tibble output in the conditional setting has a similar
structure as \texttt{calc\_assoc} with an additional \texttt{by} column
representing the levels of the categorical variable. The \texttt{x} and
\texttt{y} variables in the output are repeated for every level of
\texttt{by} variable. In order to have multiple \texttt{by} variables,
the function \texttt{calc\_assoc} is used multiple times with a
different \texttt{by} variable each time and then the multiple outputs
are binded row wise.

\begin{Schunk}
\begin{Sinput}
bike_s_assoc_by <- calc_assoc(d = bike_s,
                            by = "workingday",
                            include.overall = TRUE)
bike_s_assoc_by
\end{Sinput}
\begin{Soutput}
#> # A tibble: 18 x 6
#>    x          y          measure measure_type by      pair_type
#>    <chr>      <chr>        <dbl> <chr>        <fct>   <chr>    
#>  1 windspeed  temp       -0.198  pearson      No      numeric  
#>  2 registered temp        0.564  pearson      No      numeric  
#>  3 weathersit temp        0.108  cancor       No      mixed    
#>  4 registered windspeed  -0.259  pearson      No      numeric  
#>  5 weathersit windspeed   0.228  cancor       No      mixed    
#>  6 weathersit registered  0.214  cancor       No      mixed    
#>  7 windspeed  temp       -0.137  pearson      Yes     numeric  
#>  8 registered temp        0.550  pearson      Yes     numeric  
#>  9 weathersit temp        0.136  cancor       Yes     mixed    
#> 10 registered windspeed  -0.210  pearson      Yes     numeric  
#> 11 weathersit windspeed   0.0795 cancor       Yes     mixed    
#> 12 weathersit registered  0.349  cancor       Yes     mixed    
#> 13 windspeed  temp       -0.158  pearson      overall numeric  
#> 14 registered temp        0.540  pearson      overall numeric  
#> 15 weathersit temp        0.121  cancor       overall mixed    
#> 16 registered windspeed  -0.217  pearson      overall numeric  
#> 17 weathersit windspeed   0.120  cancor       overall mixed    
#> 18 weathersit registered  0.282  cancor       overall mixed
\end{Soutput}
\end{Schunk}

By default, the function \texttt{calc\_assoc} calculates the association
measures for all the variable pairs at different levels of the grouping
variable and the pairwise association measures for the ungrouped data
(\texttt{overall}) when used with the \texttt{by} argument. This
behavior can be changed by setting the \texttt{include.overall} argument
to \texttt{FALSE}.

\begin{Schunk}
\begin{Sinput}
bike_s_assoc_by <- calc_assoc(d = bike_s,
                            by = "workingday",
                            include.overall = FALSE)
bike_s_assoc_by
\end{Sinput}
\begin{Soutput}
#> # A tibble: 12 x 6
#>    x          y          measure measure_type by    pair_type
#>    <chr>      <chr>        <dbl> <chr>        <fct> <chr>    
#>  1 windspeed  temp       -0.198  pearson      No    numeric  
#>  2 registered temp        0.564  pearson      No    numeric  
#>  3 weathersit temp        0.108  cancor       No    mixed    
#>  4 registered windspeed  -0.259  pearson      No    numeric  
#>  5 weathersit windspeed   0.228  cancor       No    mixed    
#>  6 weathersit registered  0.214  cancor       No    mixed    
#>  7 windspeed  temp       -0.137  pearson      Yes   numeric  
#>  8 registered temp        0.550  pearson      Yes   numeric  
#>  9 weathersit temp        0.136  cancor       Yes   mixed    
#> 10 registered windspeed  -0.210  pearson      Yes   numeric  
#> 11 weathersit windspeed   0.0795 cancor       Yes   mixed    
#> 12 weathersit registered  0.349  cancor       Yes   mixed
\end{Soutput}
\end{Schunk}

\hypertarget{calculating-multiple-association-measures}{%
\subsection{Calculating multiple association
measures}\label{calculating-multiple-association-measures}}

The comparison of multiple association measures help discover patterns
other than linear. We calculate multiple measures with
\texttt{calc\_assoc\_all} function in the package. The function takes a
dataset and a list of measures as input and outputs a tibble structure
with multiple measures of association for every variable pair. This
output is used by the plotting functions to produce multiple measures
display in different layout. The code section below calculates
\texttt{pearson}, \texttt{dcor} and \texttt{cancor} measures for the
variable pairs in subset of bike sharing data. The pairs for which a
measure is not defined is not included in the result.

\begin{Schunk}
\begin{Soutput}
#> # A tibble: 16 x 5
#>    x          y          measure measure_type pair_type
#>    <chr>      <chr>        <dbl> <chr>        <chr>    
#>  1 windspeed  temp       -0.158  pearson      numeric  
#>  2 registered temp        0.540  pearson      numeric  
#>  3 registered windspeed  -0.217  pearson      numeric  
#>  4 windspeed  temp        0.158  cancor       numeric  
#>  5 registered temp        0.540  cancor       numeric  
#>  6 weathersit temp        0.121  cancor       mixed    
#>  7 workingday temp        0.0527 cancor       mixed    
#>  8 registered windspeed   0.217  cancor       numeric  
#>  9 weathersit windspeed   0.120  cancor       mixed    
#> 10 workingday windspeed   0.0188 cancor       mixed    
#> 11 weathersit registered  0.282  cancor       mixed    
#> 12 workingday registered  0.304  cancor       mixed    
#> 13 workingday weathersit  0.0613 cancor       factor   
#> 14 windspeed  temp        0.181  dcor         numeric  
#> 15 registered temp        0.531  dcor         numeric  
#> 16 registered windspeed   0.208  dcor         numeric
\end{Soutput}
\end{Schunk}

\hypertarget{section-5-corvis-visualising-association}{%
\section{Section 5: corVis: Visualising
Association}\label{section-5-corvis-visualising-association}}

This section provides a detailed description of the novel visualisation
techniques proposed in the package \CRANpkg{corVis}. These methods
display measures of association and conditional association for every
variable pair in a dataset and show multiple bivariate measures of
association simultaneously. The package includes functions such as
\texttt{plot\_assoc\_matrix} and \texttt{plot\_assoc\_linear} to produce
these displays in matrix and linear layout respectively. In addition,
the package also provides a function \texttt{show\_assoc} for a quick
graphical overview of the relationship between two variables. It
displays a scatterplot for numeric pair, bar plot for ordered and factor
pair, and box plot for mixed variable pair.

\hypertarget{association-plots}{%
\subsection{Association plots}\label{association-plots}}

For association analysis, we start with calculating the default
association measures for the bike sharing data (we drop variables
dteday, weekday, atemp and cnt) using \texttt{calc\_assoc} and then plot
this result using \texttt{plot\_assoc\_matrix} in a matrix layout in
Figure \ref{fig:assoc-matrix-bike}.

\begin{Schunk}
\begin{Sinput}
bike$dteday <- NULL 
bike$weekday <- NULL
bike$atemp <- NULL
bike$cnt <- NULL

bike_assoc <- calc_assoc(d = bike)
plot_assoc_matrix(lassoc = bike_assoc)
\end{Sinput}
\begin{figure}

{\centering \includegraphics{rj_paper_files/figure-latex/assoc-matrix-bike-1} 

}

\caption[Association matrix display for bike sharing data showing Pearson's correlation for the numeric pairs, Goodman Kruskal's gamma measure for ordered pairs and canonical correlation for factor pairs and mixed pairs]{Association matrix display for bike sharing data showing Pearson's correlation for the numeric pairs, Goodman Kruskal's gamma measure for ordered pairs and canonical correlation for factor pairs and mixed pairs. The off diagonal cells show the measure value for a variable pair using a square glyph. The color of every square is mapped with the measure value for the pair and the area of the square is mapped to absolute measure value for the corresponding variable pair. The plot shows many pairs with strong association, for example (casual, temp), (registered,yr) and (weathersit,hum). Also, there is a negative association for (windspeed,registered) suggesting the number of registered users decreased during windy days.}\label{fig:assoc-matrix-bike}
\end{figure}
\end{Schunk}

The diagonal cells in Figure \ref{fig:assoc-matrix-bike} represent the
variables present in the data. Every off diagonal cell contains a glyph,
square in this plot, which is filled with a divergent color scale
representing the value of corresponding association measure for a
variable pair. The \texttt{glyph} argument can be either \texttt{square}
or \texttt{circle}. The area of the square is mapped to absolute value
of the association measure which quickly highlights the associated pairs
of variables. We also offer ordering of the variables in this display so
that highly-associated variables are arranged closer to each other and
the task of detecting patterns becomes easier. The argument
\texttt{var\_order} is used for the variables in the matrix display. The
function uses average linkage hierarchical clustering of the association
matrix for ordering the variables, which clusters the highly associated
variables together and arranges them nearby.

Figure \ref{fig:assoc-matrix-bike} presents the novel feature of our
display showing all the variables of a dataset in the same plot compared
to corrgram which only shows association between numeric pairs. With
canonical correlation as association measure for factor pairs or mixed
pairs, we can observe from Figure \ref{fig:assoc-matrix-bike} that pairs
such as (weathersit, humidity), (workingday, registered), (yr,casual),
(season, casual) and (season, registered) are strongly associated.

In some cases, an analyst might want to handle some factors as ordinals
to see the direction of association. As discussed in the previous
section, we can convert variable types by specifying the
\texttt{coerce\_types} argument. The code below shows an implementation
and produces a display with some factor variables as ordinals.

\begin{Schunk}
\begin{Sinput}
bike_assoc_o <- calc_assoc(bike, 
                           coerce_types=list(ordinal=c("workingday", 
                                                       "yr", 
                                                       "weathersit", 
                                                       "holiday")))

plot_assoc_matrix(bike_assoc_o,
                  glyph="circle")
\end{Sinput}
\begin{figure}

{\centering \includegraphics{rj_paper_files/figure-latex/coerce_types_display-1} 

}

\caption[Association matrix display for bike sharing data showing Pearson's correlation for the numeric pairs, Goodman Kruskal's gamma measure for ordered pairs, canonical correlation for factor pairs and mixed pairs]{Association matrix display for bike sharing data showing Pearson's correlation for the numeric pairs, Goodman Kruskal's gamma measure for ordered pairs, canonical correlation for factor pairs and mixed pairs. The color of every circle is mapped with the measure value for the pair and the area of the circle is mapped by absolute measure value for the corresponding variable pair. The variables workingday, yr, weathersit and holiday have been converted to ordinals. The plot shows a strong negative association for (workingday, holiday) because no holiday is a working day.}\label{fig:coerce_types_display}
\end{figure}
\end{Schunk}

Figure @ref(fig:coerce\_types\_display) shows a strong negative
association for (workingday, holiday) as holidays are not working days.

We use function \texttt{show\_assoc} to to explore associated variable
pairs graphically. Figure \ref{fig:int-pairs-bike} display scatterplots
for pairs (temp,registered) and (windspeed,hum) showing a strong
positive and negative trend respectively. The boxplot for pair
(workingday,casual) shows a high number of casual users using bikes on
days that were not working day. The barplot for variable pair
(workingday, holiday) confirms that no working day was a holiday.

\begin{Schunk}
\begin{figure}
\includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-bike-1} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-bike-2} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-bike-3} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-bike-4} \caption[Scatterplots for numeric pair (temp,registered) and (windspeed,hum),  boxplot for mixed pair (workingday,casual) and barplot for ordinal pair ((workingday, holiday) showing association between the pairs of variables]{Scatterplots for numeric pair (temp,registered) and (windspeed,hum),  boxplot for mixed pair (workingday,casual) and barplot for ordinal pair ((workingday, holiday) showing association between the pairs of variables.}\label{fig:int-pairs-bike}
\end{figure}
\end{Schunk}

\hypertarget{multiple-association-measures-plot}{%
\subsection{Multiple Association Measures
Plot}\label{multiple-association-measures-plot}}

The multiple measures plot compares association measures for variable
pairs in a dataset. This display is useful in detecting pairs showing
non-linear association which then can be explored further in more
detail. The first step in producing the display is to calculate multiple
pairwise association measures for a dataset using
\texttt{calc\_assoc\_all} function. The output of the function is then
fed into either \texttt{plot\_assoc\_matrix} or
\texttt{plot\_assoc\_linear} to produce a display with matrix or linear
layout.

The \texttt{plot\_assoc\_matrix} function constructs a matrix display
where the diagonal cells represent the variables and off-diagonal cells
show variable pairs with multiple association measures as lollipop. The
height and colour of the lollipops are mapped with the absolute value
and by the type of association measure. An association measure tibble
including every variable pair is the required input.

For ordering the display, the argument \texttt{var\_order} is set to
\texttt{max\_diff} which creates a matrix with entries of maximum
difference between the absolute value of measures for a variable pair.
The variable ordering is then taken from the hierarchical clustering
using average linkage method of this matrix. This orders the cells with
large difference between the measures close to the diagonal and are
easier to identify.

Figure \ref{fig:compare-matrix} shows a multiple association measures
plot in matrix layout for bike sharing dataset. We convert the factor
variable \texttt{mnth} into numeric and use only numeric variables to
produce the display. The plot compares the absolute values of
association measures such as \texttt{ace}, \texttt{cancor},
\texttt{dcor}, \texttt{kendall}, \texttt{mic}, \texttt{nmi},
\texttt{pearson} and \texttt{spearman} for every variable pair in the
dataset.

\begin{Schunk}
\begin{Sinput}
biken <- bike |>
  mutate(mnth=as.numeric(mnth)) |>
  select(where(is.numeric))

biken_assoc_all <-calc_assoc_all(biken)
# all measures are positive, so change to
plot_assoc_matrix(biken_assoc_all) # label position is now wrong!
\end{Sinput}
\begin{figure}

{\centering \includegraphics{rj_paper_files/figure-latex/compare-matrix-1} 

}

\caption[Multiple association measures plot in a matrix layout for numeric variables in bike sharing data]{Multiple association measures plot in a matrix layout for numeric variables in bike sharing data. The lollipops in each cell represent the value of the association measure colored by the type of measure. The variable pairs are ordered by the maximum difference between the absolute value of association measures such that cells with highest difference are close to the diagonal. The plot shows that pairs (casual,mnth) and (mnth,temp) might have a non-linear association which can be explored further.}\label{fig:compare-matrix}
\end{figure}
\end{Schunk}

It is evident from the Figure \ref{fig:compare-matrix} that pairs
(casual,mnth) and (mnth,temp) have higher value for \texttt{ace}
compared to other measures. The measures \texttt{nmi}, \texttt{dcor} and
\texttt{mic} have similar values but higher than \texttt{pearson},
\texttt{spearman} and \texttt{kendall}. This suggests the presence of a
non-linear pattern for these pairs.

We use \texttt{show\_assoc} to explore the pattern for these variable
pairs in Figure \ref{fig:int-pairs-multiple}. It is evident from the
scatterplots that both (casual,mnth) and (mnth,temp) show a non-linear
relationship which measures such as Pearson, Kendall or Spearman
correlation failed to capture. The \texttt{ace} measure detects this
non-linear association efficiently as the \texttt{ace} algorithm
estimates the transformations of variables which leads to maximal
correlation for the variable pair and uncovers non-linear pattern.

\begin{Schunk}
\begin{figure}
\includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-multiple-1} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-multiple-2} \caption[Scatterplot for variable pairs (from left to right) (casual,mnth) and (mnth,temp) showing a non-linear relationship for these pairs]{Scatterplot for variable pairs (from left to right) (casual,mnth) and (mnth,temp) showing a non-linear relationship for these pairs.}\label{fig:int-pairs-multiple}
\end{figure}
\end{Schunk}

\hypertarget{conditional-association-plot}{%
\subsection{Conditional Association
Plot}\label{conditional-association-plot}}

The conditional association plot explores bivariate association at
different levels of a categorical variable. This display is useful for
identifying pairs of variables showing different patterns at different
levels of a conditioning variable. To produce this display, the first
step is to calculate association measures for the variable pairs using
\texttt{calc\_assoc} function at each level of conditioning variable
which is specified using the \texttt{by} argument. The calculated
association measures are then used as inputs to
\texttt{plot\_assoc\_matrix} or \texttt{plot\_assoc\_linear} to produce
a display with matrix or linear layout.

The \texttt{plot\_assoc\_matrix} function constructs a conditional
association matrix display where the diagonal cells represent the
variables and off-diagonal cells show variable pairs with association
measures as lollipops for levels of a conditioning variable. The height
and colour of the lollipops are mapped with the value of association
measure and level of the conditioning variable respectively. The overall
value of association measure for the corresponding pair of variable in a
cell is represented by a pink horizontal line. The function takes an
association measure tibble including every variable pair as the required
input.

For ordering the display, the argument \texttt{var\_order} is set to
either \texttt{default} or \texttt{max\_diff}. The default ordering is
taken from the ordering of variables obtained by applying average
linkage hierarchical clustering to the matrix of overall association
measure. When \texttt{var\_order} is set to \texttt{max\_diff}, a matrix
with entries of maximum difference of association measure at different
levels of conditioning variable for a variable pair is created and
clustered using hierarchical method to get the ordering of the
variables.

Figure \ref{fig:cond-assoc} shows a conditional association plot for the
bike sharing data in matrix layout. Each cell corresponding to a
variable pair shows four lollipops which correspond to the association
measure (Pearson's correlation for numeric pairs, Goodman and Kruskal's
gamma for ordinal pair, canonical correlation for nominal or mixed
pairs) calculated at the levels of conditioning variable
\texttt{season}. The horizontal pink line represents the overall
association measure for the pair. The plot shows a low overall
correlation between hum and temp. This is also true in Spring and
Winter, but the association is positive in fall and negative in Summer.
Also, the overall correlation between registered and temp is moderate
and positive. This is also true in each season except for summer where
the correlation is about 0. The same pattern also holds for casual.

\begin{Schunk}
\begin{Sinput}
bike_by_assoc <- select(bike, -workingday, -holiday, -mnth, -yr) |>
  calc_assoc(by="season", 
                  coerce_types=list(ordinal=c( "weathersit")))


plot_assoc_matrix(bike_by_assoc)
\end{Sinput}
\begin{figure}

{\centering \includegraphics{rj_paper_files/figure-latex/cond-assoc-1} 

}

\caption[Conditional Association plot for bike sharing data showing Pearson's correlation for numeric pairs, Goodman and Kruskal's gamma for ordinal pair, canonical correlation for nominal or mixed pairs]{Conditional Association plot for bike sharing data showing Pearson's correlation for numeric pairs, Goodman and Kruskal's gamma for ordinal pair, canonical correlation for nominal or mixed pairs. The lollipops in each cell represent the value for asssociation measure colored by the conditioning variable season. The pink horizontal line in each cell represents overall value of the association measure. The plot shows evident difference in measure value for pairs (temp, hum), (temp, registered), (temp, casual) and (registered, casual) for different seasons.}\label{fig:cond-assoc}
\end{figure}
\end{Schunk}

We explore these variable pairs in more detail using
\texttt{show\_assoc}. Figure \ref{fig:int-pairs-conditional} shows
scatterplots for variable pairs (temp, hum), (temp, registered), (temp,
casual) and (registered, casual) faceted by conditioning variable
season. The faceted scatterplot for (temp, hum) show the decrease in
humidity with increase in temperature in Summer and the oppsoite during
Fall. Clearly, the plot for (temp, registered) and (temp, casual) show
that there is no clear pattern for registered and casual with
temperature in Summer compared to other seasons.

\begin{Schunk}
\begin{figure}
\includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-conditional-1} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-conditional-2} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-conditional-3} \includegraphics[width=0.5\linewidth]{rj_paper_files/figure-latex/int-pairs-conditional-4} \caption[Scatterplots for variable pairs (temp, hum), (temp, registered), (temp, casual) and (registered, casual) faceted by conditioning variable season]{Scatterplots for variable pairs (temp, hum), (temp, registered), (temp, casual) and (registered, casual) faceted by conditioning variable season}\label{fig:int-pairs-conditional}
\end{figure}
\end{Schunk}

We also use linear layouts for displaying conditional association in the
package. The function \texttt{plot\_assoc\_linear} is used for
displaying a linear layout of the conditional association for variable
pairs in the dataset. The association measures are calculated for every
variable pair at each level of partitioning variable using
\texttt{calc\_assoc} function with conditioning variable as the
\texttt{by} argument. The function takes an association measure tibble
with every variable pair (not necessarily) as the required input. The
measures are then displayed using a dotplot (or a heatmap) where color
of the dots (or each cell) is coded by the level of the partitioning
variable and the variable pairs are ordered by absolute maximum value of
association measure for each of the pair of variable. These displays are
also efficient for discovering differences among the levels of
partitioning variable in the data. In comparison to matrix layout, it is
easier to omit less relevant pairs of variables in linear layouts by
filtering the variables pairs having a higher value for association
measures than a threshold.

Figure \ref{fig:linear-cond-assoc} shows a linear display for
conditional association measures with the variable pairs having absoulte
measure value greater than \(0.2\) along the Y-axis, the value of
association measure along X-axis and color of the points representing
the level of the grouping variable. The linear layout becomes more
useful over the matrix layout for conditional association display when
the number of variables and number of levels of grouping variable are
high.

\begin{Schunk}
\begin{Sinput}
bike_by_assoc <- select(bike, -workingday, -holiday, -mnth, -yr) |>
  calc_assoc(by="season", 
                  coerce_types=list(ordinal=c( "weathersit")))
bike_by_assoc <- dplyr::filter(bike_by_assoc, abs(measure) > 0.2)
plot_assoc_linear(assoc = bike_by_assoc,
                  plot_type = "dotplot")
\end{Sinput}
\begin{figure}

\includegraphics{rj_paper_files/figure-latex/linear-cond-assoc-1} \hfill{}

\caption[Conditional Association plot for bike sharing data using linear layout.The display has variable pairs on the Y-axis and the value of association measures on the X-axis]{Conditional Association plot for bike sharing data using linear layout.The display has variable pairs on the Y-axis and the value of association measures on the X-axis. The points corresponding to every variable pair represents the value of association measure for different levels of the conditioning variable and the overall value of association measure.}\label{fig:linear-cond-assoc}
\end{figure}
\end{Schunk}

\hypertarget{section-5-discussion}{%
\section{Section 5: Discussion}\label{section-5-discussion}}

We use multiple association measures in a single display for different
variable pairs which serves as a comparison tool while exploring
association in a dataset and assist in identifying unusual variable
pairs. These multiple measures can be displayed in a scatterplot matrix
similar to what \citet{tukey1985computer} proposed. They suggested that
scatterplot matrix of the scagnostics measures, which are measures
summarizing a scatterplot, can be used to identify unusual scatterplots
or variable pairs. \citet{wilkinson2005graph} used this idea with their
graph-theoretic scagnostic measures to highlight unusual scatterplots.
Similarly, \citet{kuhn2013applied} have used this idea in a predictive
modeling context. They have produced a scatterplot matrix of the
measures between the response and continuous predictors such as
Pearson's correlation coefficient, pseudo-\(R^2\) from the locally
weighted regression model, MIC and Spearman's rank correlation
coefficient to explore the predictor importance during feature selection
step. These displays show the importance of comparing multiple
association measures at once for different variable pairs.

\bibliography{RJreferences.bib}

\address{%
Amit Chinwan\\
Maynooth University\\%
Hamilton Institute\\ Maynooth, Ireland\\
%
%
%
\href{mailto:amit.chinwan.2019@mumail.ie}{\nolinkurl{amit.chinwan.2019@mumail.ie}}%
}

\address{%
Catherine Hurley\\
Maynooth University\\%
Department of Mathematics and Statistics\\ Maynooth, Ireland\\
%
%
%
\href{mailto:catherine.hurley@mu.ie}{\nolinkurl{catherine.hurley@mu.ie}}%
}
