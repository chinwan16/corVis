---
title: "Introduction to corVis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{intro_corVis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(corVis)
library(mlr3data)
library(MLDataR)
library(dplyr)
```


```{r setup2, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE,fig.align = "center",fig.height = 10,fig.width = 10)
```

corVis is an R package which calculates different correlation measures for a dataset and can help in visualising these correlations in different ways. These displays can help find interesting patterns in a dataset.

## Correlation

Correlation is a measure of association between two random variables. There are different methods which have been proposed to calculate the strength (or direction) of association. For example, pearson's correlation coefficient calculates the strength and direction of the linear association present between two variables and it is in the range $[-1,1]$. A correlation measure can be considered a good measure if it is symmetric. Correlation measures serve as important tools during the Exploratory Data Analysis (EDA) process. These measures can be used for screening variables which are highly correlated in a high-dimensional dataset prior to modeling.

In this package we provide a range of correlation measures which can capture linear and non-linear associations between two variables. The available correlation measures include - *pearson*, *spearman*, *kendall*, *distance*, *maximal information coefficient (mic)*.A user can use `calc_assoc` to calculate one of these correlation measure between the variable pairs in the dataset.

```{r}
library(readr)
breast_cancer_coimbra <- read_csv("../data/breast_cancer_coimbra.csv")

dplyr::glimpse(breast_cancer_coimbra)

df <- breast_cancer_coimbra
df$Classification <- ifelse(df$Classification=="1","control","patients")

numeric_vars <- names(df[sapply(df,is.numeric)])

dplyr::glimpse(calc_assoc(df))
```

A functionality to calculate correlation among the variable pairs in a grouped setting has been introduced in  `calc_assoc_by`. One can use `by` to specify a grouping variable and the association measure will be calculated for all the variable pairs at each level of the grouping variable. 

```{r}
assoc_by <- calc_assoc_by(d = df,by = "Classification",types = default_assoc())
glimpse(assoc_by)
```

## Visualisating Association

The package also helps in plotting the calculated measures of association in different displays. We have provided both matrix as well as linear layout for displaying these measures. A user can pick either display to visualise the associations.

### Traditional heatmap

```{r}
assoc <- calc_assoc(df, types = default_assoc())
association_heatmap(assoc)
association_heatmap(calc_assoc(ilpd))
```


## Visualising Conditional Association

### Matrix-Layout Visualisation

The default seriation is by the overall correlation between pairs of variables. One could choose the maximum difference between the levels or overall as the measure for seriating the barplot. It would assist an analyst in locating interesting displays easily.
```{r}
b <- calc_assoc_by(df, by="Classification")
pairwise_summary_plot(b)

```

Different measures of association on same plot
```{r}

spearman_assoc <- default_assoc()
spearman_assoc$argList[[1]] <- list(method="spearman")
pearson <- calc_assoc(iris[,1:4])
spearman <- calc_assoc(iris[,1:4], types=spearman_assoc)
pairwise_summary_plot(a <- rbind(pearson,spearman), group_var = "measure_type")
```


### Linear-layout Visualisation

Linear layouts are more space-efficient than matrix layouts, but lookup is more challenging. Variable pairs can be ordered by relevance (usually difference in measures of association or across the factor levels), and less relevant pairs can be omitted. Linear displays are also suitable to display associations between the response and predictors only.

### Funnel plot for all the pairs

```{r}
b <- calc_assoc_by(df, by="Classification")

pairwise_linear_plot(b)
```





